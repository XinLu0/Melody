<!DOCTYPE html>
<html lang="en">
	<head>
		<?php
		/* 
  		Template Name: Update
  		*/
  		session_start();

  		//to be deprecated
  		$_SESSION['username']=1006;
		$_SESSION['loggedin']=1;

  		$logout=@$_GET['logout'];
  		if($logout ==1)
  			$_SESSION['loggedin']=0;
  		if($_SESSION['loggedin']!=1)
  		{
  			header("Location:http://www.melodysac.com.sg/index.php/zh/testing/");
  			exit;
  		}
  		$mid = $_SESSION['username'];
  		function updateEmailByMID($Mid,$email){
			global $wpdb;
			$wpdb->query($wpdb->prepare( "UPDATE `Teacher_infor` SET Email=\"$email\" WHERE Member = $Mid"));
		}
		function updatePasswordByMID($Mid,$password){
			global $wpdb;
			$wpdb->query($wpdb->prepare( "UPDATE `Teacher_infor` SET Password=\"$password\" WHERE Member = $Mid"));
		}
		function updateContactNoByMID($Mid,$Contact_no){
			global $wpdb;
			$wpdb->query($wpdb->prepare( "UPDATE `Teacher_infor` SET Contact_no=\"$Contact_no\" WHERE Member = $Mid"));
		}
		function alert($msg) {
		echo "<script type='text/javascript'>alert('$msg');</script>";
		}
  		if(isset($_POST["Number"])) {
  			if($_POST["Number"]!=""){
  				updateContactNoByMID($mid,$_POST["Number"]);
  			}
  			if($_POST["NewPassword1"]!=""){
  				if($_POST["NewPassword1"]!=$_POST["NewPassword2"])
  					alert("Passwords don't match");
  				else {
  					updatePasswordByMID($mid,$_POST["NewPassword1"]);
  				}
  			}
  			if($_POST["Email"]!=""){
  				updateEmailByMID($mid,$_POST["Email"]);
  			}
  		}
		?>
		<meta charset="utf-8">
		<style>
	    	* {
				box-sizing: border-box;
			}

			body {
				margin: 0;
				background-image: linear-gradient(white, grey);
				height: 1000px;
			}

			/* Style the header */
			.header {
				background-color: #ffffff;
				padding: 1px;
				text-align: center;
			}

			/* Style the top navigation bar */
			.topnav {
				overflow: hidden;
				background-color: #333;
			}

			/* Style the topnav links */
			.topnav a {
				float: left;
				display: block;
				color: #f2f2f2;
				text-align: center;
				padding: 14px 16px;
				text-decoration: none;
			}

			/* Change color on hover */
			.topnav a:hover {
				background-color: #ddd;
				color: black;
			}

			.topnav button {
				float: right;
				display: block;
				color: white;
				background-color: #333;
				text-align: center;
				padding: 14px 16px;
				text-decoration: none;
				border: 0px;
			}

			.update {
				border-radius: 5px;
				background-color: #f2f2f2;
				padding: 20px;
				max-width: 550px;
				margin: auto;
				border: 1px solid gray;
			}

			input[type=text] {
			    width: 100%;
			    padding: 12px 20px;
			    margin: 8px 0;
			    display: inline-block;
			    border: 1px solid #ccc;
			    border-radius: 4px;
			    box-sizing: border-box;
			}

			input[type=submit] {
			    width: 100%;
			    background-color: #A6502D;
			    color: white;
			    padding: 14px 20px;
			    margin: 8px 0;
			    border: none;
			    border-radius: 4px;
			    cursor: pointer;
			}

			input[type=submit]:hover {
			    background-color: #8C2A05;
			}
		</style>
	</head>

	<body>
		<div class="header">
			<img src="<?php echo get_template_directory_uri(); ?>/test/melody.jpg">
		</div>

		<div class="topnav">
			<a href="http://www.melodysac.com.sg/index.php/en/table2/">Table</a>
			<a href="http://www.melodysac.com.sg/index.php/en/contact/">Contact Us</a>
			<form action="#" method="get">
				<button name="logout" value = 1>Logout</button>
			</form>
		</div>
		<br>
		<br>
		<br>
		<div class="update">
			<h2>Update Your Profile</h2>
			<form name="update_profile" method="post">
				<p>
					<label for="number">Contact Number</label>
					<input type="text" id="number" name="Number">
				</p>
				<p>
					<label for="Email">Email</label>
					<input type="text" id="Email" name="Email">
				</p>
				<p>
					<label for="NPassword1">New Password</label>
					<input type="text" id="NPassword1" name="NewPassword1">
				</p>
				<p>

					<label for="NPassword2">Confirm New password</label>
					<input type="text" id="NPassword2" name="NewPassword2">

				</p>
				<p>
					<input type="submit" value="Submit">
				</p>
			</form>
		</div>
	</body>
</html>